@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
  .glass {
    background: var(--theme-surface, var(--glass-bg));
    backdrop-filter: blur(20px);
    border-radius: 1rem;
    border: 1px transparent var(--theme-surface-border, var(--glass-border));
    box-shadow: 0 0 25px rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
  }

  /* Toss? */
  .card-accent {
    background: radial-gradient(
      circle at 50% 50%,
      var(--theme-card-sheen),
      transparent 50%
    );
    transition: box-shadow 0.3s ease;
  }

  /* Toss? */
  .card-accent:hover {
    box-shadow:
      0 0 30px var(--theme-card-shadow),
      0 0 60px color-mix(in srgb, var(--theme-card-shadow) 40%, transparent);
  }

  /* Toss? */
  .gradient-text {
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    background-clip: text;
    -webkit-background-clip: text;
    color: transparent;
  }

  .topic-page {
    position: relative;
    min-height: 100vh;
    @apply flex flex-col items-center overflow-hidden px-6 py-20 text-center;
    gap: clamp(3rem, 6vw, 5rem);
    isolation: isolate;
  }

  .topic-page::before {
    content: "";
    position: fixed;
    inset: -25% -10%;
    background:
      radial-gradient(circle at 18% 20%, var(--theme-blob-1), transparent 55%),
      radial-gradient(circle at 80% 0%, var(--theme-blob-2), transparent 55%);
    filter: blur(60px);
    opacity: 0.85;
    z-index: -2;
  }

  .topic-page::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image: radial-gradient(
      circle,
      var(--theme-symbol-color) 1px,
      transparent 1px
    );
    background-size: 4px 4px;
    opacity: 0.18;
    mix-blend-mode: screen;
    z-index: -1;
  }

  .topic-page .floating-symbol {
    color: var(--theme-symbol-color);
    text-shadow: 0 0 30px color-mix(in srgb, var(--theme-symbol-color) 30%, transparent);
  }

  .topic-grid {
    @apply grid w-full max-w-6xl gap-10;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  }

  .topic-card {
    @apply relative block overflow-hidden rounded-3xl border p-8 text-left transition-transform duration-200 ease-out;
    background: linear-gradient(
      145deg,
      rgba(15, 23, 42, 0.555),
      rgba(2, 6, 23, 0.123)
    );
    border-color: transparent;
    box-shadow:
      0 20px 45px rgba(2, 6, 23, 0.55),
      0 0 0 1px rgba(255, 255, 255, 0.02);
    color: var(--text);
  }

  .topic-card-wide {
    @apply md:col-span-2;
  }

  .topic-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      120deg,
      transparent 0%,
      color-mix(in srgb, var(--theme-card-sheen) 55%, transparent) 45%,
      transparent 80%
    );
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 0;
  }

  .topic-card:hover::after {
    opacity: 1;
  }

  .topic-card > * {
    position: relative;
    z-index: 1;
  }

  .header {
    @apply relative block overflow-hidden p-8 text-left transition-transform duration-200 ease-out;
    background: linear-gradient(11deg, rgba(0, 0, 0, 0), var(--theme-blob-1), var(--theme-blob-2), rgba(15, 15, 15, 0.582));
    border-color: transparent;
    box-shadow:
      0 20px 45px rgba(2, 6, 23, 0.55),
      0 0 0 1px rgba(255, 255, 255, 0.02);
    color: var(--text);
    rotate: -2deg;
    font-style: italic;
  }

  .glass-sub {
    background: var(--theme-surface, var(--glass-bg));
    backdrop-filter: blur(20px);
    border: transparent;
    border-radius: 1rem;
    box-shadow: 0 0 25px rgba(59, 59, 59, 0.164);
    transition: all 0.3s ease;
    padding: 1rem;
  }

  .scroll-bar{
    scrollbar-color: transparent transparent;
  }


  
 /* --- Glossary Term Tooltip --- */
.term-highlight {
  @apply relative cursor-help border-b border-cyan-400/50 font-semibold text-cyan-300 transition-colors hover:text-cyan-200;
}
.term-highlight::after {
  @apply pointer-events-none absolute bottom-full left-1/2 z-10 mb-2 w-max max-w-xs -translate-x-1/2 scale-95 rounded-md border border-neutral-700 bg-neutral-900 p-3 text-sm font-medium text-neutral-200 opacity-0 shadow-lg transition-all;
  content: attr(data-tooltip);
}
.term-highlight:hover::after {
  @apply scale-100 opacity-100;
}

  /* Lesson/app-specific helpers */
  .applet-card {
    @apply rounded-lg border border-neutral-800 bg-neutral-900/50 p-5 shadow-sm transition-colors;
  }
  .applet-card:hover {
    @apply hover:border-cyan-600/30 hover:bg-neutral-900/60;
  }
  .applet-header {
    @apply text-xs font-semibold uppercase tracking-[0.2em] text-teal-200;
  }
  .note-card {
    @apply rounded-lg border border-neutral-800 bg-neutral-900/40 p-4;
  }
  .two-col {
    @apply grid gap-8 md:grid-cols-2 lg:gap-10;
  }
}

/* Formal Science Theme Enhancements */
.theme-formal-science.topic-page {
  --theme-grid-color: rgba(209, 35, 4, 0.062);
  background-image: conic-gradient(
      from 90deg at 1px 1px,
      var(--theme-grid-color) 90deg,
      transparent 0
    ),
    conic-gradient(
      from 90deg at 1px 1px,
      var(--theme-grid-color) 90deg,
      transparent 0
    );
  background-size:
    50px 50px,
    50px 50px;
  background-position:
    0 0,
    0 0;
  animation: animatedGrid 10s linear infinite;
}
.theme-formal-science.topic-page::before {
  content: "";
  position: absolute;
  top: 10%;
  left: 10%;
  width: 300px;
  height: 300px;
  background: none;
  border: 2px solid rgba(255, 0, 0, 0.589);
  border-radius: 1rem;
  opacity: 0.5;
  filter: blur(6px);
  animation: spin 30s linear infinite;
}


/* Math Theme Enhancements */
.theme-algebra.topic-page {
    background-image:
      linear-gradient(var(--theme-grid-color) 1px, transparent 1px),
      linear-gradient(90deg, var(--theme-grid-color) 1px, transparent 1px);
    background-size: 40px 40px;
    background-position: -1px -1px;
}
.theme-elementary-algebra.topic-page {
  background-image:
    linear-gradient(var(--theme-grid-color) 1px, transparent 1px),
    linear-gradient(90deg, var(--theme-grid-color) 1px, transparent 1px);
  background-size: 40px 40px;
  background-position: -1px -1px;
}
.theme-elementary-algebra-foundations.topic-page {
  background-image: radial-gradient(var(--theme-grid-color) 1px, transparent 1px);
  background-size: 20px 20px;
}

/* Natural Science Theme Enhancements */
.theme-natural-science.topic-page::before {
  content: "";
  position: absolute;
  top: 5%;
  left: 10%;
  width: 150px;
  height: 150px;
  border-radius: 50%;
  background: 
    radial-gradient(circle, rgb(0, 255, 255) 5%, transparent 60%),
    radial-gradient(circle, rgb(0, 255, 242) 5%, transparent 60%),
    radial-gradient(circle, rgb(0, 238, 255) 100%, transparent 60%);
  opacity: 0.2;
  filter: blur(10px);
  will-change: transform, opacity;
  animation: floatAround 40s ease-in-out infinite alternate;
}
.theme-natural-science.topic-page::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image: 
    radial-gradient(circle at 80% 20%, green 0%, transparent 70%),
    radial-gradient(circle at 5% 10%, blue 1%, transparent 70%),
    radial-gradient(circle at 50% 80%, red 0%, transparent 70%);
  background-size: 100% 100%;
  background-position: 0 0;
  opacity: 0.15;
  animation: pulseFade 15s ease-in-out infinite;
  will-change: transform, opacity;
}
.theme-natural-science .floating-symbol {
  animation: pulseFade 12s ease-in-out infinite;
  opacity: 0;
  will-change: opacity, transform;
  animation-name: pulseFade;
}